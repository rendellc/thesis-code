settings:
  pdfdir: ../figs
  rawdir: ../figs/raw
  datadir: ../data
experiments:
  wheel_state_errors:
    runner: run_command
    plotter: make_bag_plots
    options:
      command: "ros2 launch launch/low_curvature.launch.py use_single_turn:=true gui:=false"
      bagsaver_config: launch/bagsaver.yaml
      rerun: true
      bag:
        file: ../bags/single_turn.db3
        force: true
        rate: 50
      plots:
        steering_angle_error:
          type: timeseries
          legend: true
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: error.steering_angle
              label: fl
              scale: rad2deg
            - topic: /vehicle/wheel_rl/controller_info
              attribute: error.steering_angle
              label: rl
              scale: rad2deg
            - topic: /vehicle/wheel_rr/controller_info
              attribute: error.steering_angle
              label: rr
              scale: rad2deg
            - topic: /vehicle/wheel_fr/controller_info
              attribute: error.steering_angle
              label: fr
              scale: rad2deg
        angular_velocity_error:
          type: timeseries
          legend: true
          ylabel: "[deg/s]"
          ylim:
            - -25
            - 25
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: error.angular_velocity
              label: fl
              scale: rad2deg
            - topic: /vehicle/wheel_rl/controller_info
              attribute: error.angular_velocity
              label: rl
              scale: rad2deg
            - topic: /vehicle/wheel_rr/controller_info
              attribute: error.angular_velocity
              label: rr
              scale: rad2deg
            - topic: /vehicle/wheel_fr/controller_info
              attribute: error.angular_velocity
              label: fr
              scale: rad2deg
  sliding_mode_results:
    plotter: make_bag_plots
    options:
      command: "ros2 launch launch/all.launch.py use_survey:=true gui:=false"
      # Support multiple commands here. Then we dont need to put everything into a single launch file
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/survey_smc.db3
        force: true
        rate: 50
      plots:
        steering_angle_error:
          type: timeseries
          ylabel: "[deg]"
          ylim:
            - -30
            - 30
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: error.steering_angle
              label: fl
              scale: rad2deg
        steering_angle_rate:
          type: timeseries
          ylabel: "[deg/s]"
          ylim:
            - -180
            - 180
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: state.steering_angle_rate
              label: fl
              scale: rad2deg
        steering_torque:
          type: timeseries
          ylabel: "[Nm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: steer_torque
              label: fl
        steering_torque_straight:
          type: timeseries
          ylabel: "[Nm]"
          xlim:
            - 35
            - 55
          ylim:
            - -100
            - 100
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: steer_torque
              label: fl
  robust_rate_results:
    plotter: make_bag_plots
    options:
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/survey_robust_rate.db3
        force: true
        rate: 50
      plots:
        steering_angle_error:
          type: timeseries
          ylabel: "[deg]"
          ylim:
            - -30
            - 30
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: error.steering_angle
              label: fl
              scale: rad2deg
        steering_angle_rate:
          type: timeseries
          ylabel: "[deg/s]"
          ylim:
            - -180
            - 180
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: state.steering_angle_rate
              label: fl
              scale: rad2deg
        steering_torque:
          type: timeseries
          ylabel: "[Nm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: steer_torque
              label: fl
        steering_torque_straight:
          type: timeseries
          ylabel: "[Nm]"
          xlim:
            - 35
            - 55
          ylim:
            - -100
            - 100
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: steer_torque
              label: fl

  vehicle_state_errors:
    plotter: make_bag_plots
    options:
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/single_turn.db3
        force: true
        rate: 50
      plots:
        yaw_error:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/controller_info
              attribute: yaw_error
              label: "$\\tilde\\psi$"
              scale: rad2deg
        cross_track_error:
          type: timeseries
          ylabel: "[cm]"
          datas:
            - topic: /vehicle/controller_info
              attribute: cross_track_error
              label: "$e_c$"
              scale: 100.0
        # vehicle_speed_error:
        #   type: timeseries
        # xlabel: "time [s]"
        # ylabel: "$\\tilde\\delta_w$ [deg]"
  fermat_line:
    #command: python3 launch/make_path_plots.py
    plotter: make_path_plots
    #- ./../build/pathlib_testing
    options:
      num-samples: 100
      waypoints:
        - 1,1
        - 3,4
        - 10,5
        - 18,3
        - 18,10
      smoothing: line
      curvatures:
        - 1.0
  circular_smoothing:
    #command: python3 launch/make_path_plots.py
    plotter: make_path_plots
    #- ./../build/pathlib_testing
    options:
      num-samples: 100
      waypoints:
        - 1,1
        - 3,4
        - 10,5
        - 18,3
        - 18,10
      smoothing: circle
      curvatures:
        - 0.4
  fermat_smoothing_curvature:
    #command: python3 launch/make_path_plots.py
    plotter: make_path_plots
    #- ./../build/pathlib_testing
    options:
      num-samples: 100
      waypoints:
        - 1,1
        - 3,4
        - 10,5
        - 18,3
        - 18,10
      smoothing: fermat
      curvatures:
        - 0.5
  fermat_smoothing_curvatures:
    #command: python3 launch/make_path_plots.py
    plotter: make_path_plots
    #- ./../build/pathlib_testing
    options:
      num-samples: 100
      waypoints:
        - 1,1
        - 3,4
        - 10,5
        - 18,3
        - 18,10
      smoothing: fermat
      curvatures:
        - 0.5
        - 1.0
        - 2.0
      labels:
        - "$\\kappa_{max} = 0.5$"
        - "$\\kappa_{max} = 1.0$"
        - "$\\kappa_{max} = 2.0$"
  fermat_smoothing_invalid:
    plotter: make_path_plots
    options:
      num-samples: 100
      waypoints:
        - 0,0
        - 5,0
        - 5,5
        - 10,5
      smoothing: fermat
      curvatures:
        - 0.4
  fermat_vs_circle:
    plotter: make_path_plots
    options:
      num-samples: 100
      waypoints:
        - 0,0
        - 5,0
        - 4,5
      smoothings:
        - line
        - fermat
        - circle
      curvatures:
        - 0.5
      labels:
        - line
        - circle
        - fermat
