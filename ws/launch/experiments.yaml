settings:
  pdfdir: /home/cale/thesis/mainmatter/fig
  # metricdir: /home/cale/thesis/data
  rawdir: ../figs/raw
  datadir: ../data
  rerun:
    - comment out this to run everything
    - smc_step
    - smc_turn
    - rr_step
    - rr_turn
    - angvel_step
    - simple_lap
    # - simple_lap_no_reference
    # - simple_lap_better_reference
    # - straight_line_convergence
    # - straight_line_convergence_spinning
    # - simple_lap_no_braking
    # - simple_lap_low_curvature
    # - simple_lap_low_speed
    # - simple_lap_circular
    # - simple_lap_low_curvature_high_speed
    # - simple_lap_low_curvature_high_speed_faster
    # - simple_lap_curvature_ff
    # - simple_lap_curvature_ff_slow
    # - simple_lap_curvature_ff_more
    # - simple_lap_curvature_ff_more_high_speed
    # - simple_lap_low_curvature_high_speed_circular
    # - noslip_yawrate
    # - noslip_yaw
  onlyrun:
    # - smc_step
    # - smc_turn
    # - rr_step
    # - rr_turn
    - angvel_step
    # - noslip_yawrate
    # - noslip_yaw
    # - straight_line_convergence
    # - straight_line_convergence_spinning
    # - simple_lap
    # - simple_lap_no_reference
    # - simple_lap_better_reference
    # - simple_lap_no_braking
    # - simple_lap_low_curvature
    # - simple_lap_low_speed
    # - simple_lap_circular
    # - simple_lap_low_curvature_high_speed
    # - simple_lap_low_curvature_high_speed_faster
    # - simple_lap_curvature_ff
    # - simple_lap_curvature_ff_slow
    # - simple_lap_curvature_ff_more
    # - simple_lap_curvature_ff_more_high_speed
    # - simple_lap_low_curvature_high_speed_circular
    # - simple_lap_path
    # - simple_lap_path_low_curvature
    # - fermat_vs_circle
    # - fermat_line
    # - circular_smoothing
    # - fermat_smoothing_curvature
    # - fermat_smoothing_curvatures
    # - fermat_smoothing_invalid
    # - chattering_signal
experiments:
  # ---- WHEEL SMC AND RR CASE STUDIES ----
  smc_step:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control report_wheel_controllers_smc.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_wheel_step.launch.py"
      monitor: TimeLimit20SecMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/smc_step.db3
        force: true
        rate: 10
      plots:
        reference_fl_raw:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference_optimal.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        reference_fl:
          type: timeseries
          ylabel: "[deg]"
          legend: true
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference.steering_angle
              label: "$\\delta_r$"
              scale: rad2deg
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference_optimal.steering_angle
              label: "$\\delta_r^*$"
              scale: rad2deg
          tlim:
            - 0
            - 20
        state_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: state.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        torque_fl:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.steer_torque
              label: fl
              scale: 0.001
          tlim:
            - 0
            - 20
        error_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: error.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        sliding_surface_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: sliding_mode_s
              label: fl
          tlim:
            - 0
            - 20
      metrics:
        mean_abs_error:
          method: meanabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.steering_angle
            tlim:
              - 0
              - 20
          scale: rad2deg
        final_abs_error:
          method: finalabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.steering_angle
            tlim:
              - 0
              - 20
          scale: rad2deg
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
          scale: 0.001
        mean_torque:
          method: mean
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
          scale: 0.001
  smc_turn:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control report_wheel_controllers_smc.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_wheel_turn.launch.py"
      monitor: TimeLimit20SecMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/smc_turn.db3
        force: true
        rate: 10
      plots:
        reference_fl_raw:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference_optimal.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        reference_fl:
          type: timeseries
          ylabel: "[deg]"
          legend: true
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference.steering_angle
              label: "$\\delta_r$"
              scale: rad2deg
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference_optimal.steering_angle
              label: "$\\delta_r^*$"
              scale: rad2deg
          tlim:
            - 0
            - 20
        state_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: state.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        torque_fl:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.steer_torque
              label: fl
              scale: 0.001
          tlim:
            - 0
            - 20
        error_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: error.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        sliding_surface_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: sliding_mode_s
              label: fl
          tlim:
            - 0
            - 20
      metrics:
        mean_abs_error:
          method: meanabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.steering_angle
            tlim:
              - 0
              - 20
          scale: rad2deg
        final_abs_error:
          method: finalabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.steering_angle
            tlim:
              - 0
              - 20
          scale: rad2deg
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
          scale: 0.001
        mean_torque:
          method: mean
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
          scale: 0.001

  rr_step:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control report_wheel_controllers_rr.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_wheel_step.launch.py"
      monitor: TimeLimit20SecMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/rr_step.db3
        force: true
        rate: 10
      plots:
        reference_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        state_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: state.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        torque_fl:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.steer_torque
              label: fl
              scale: 0.001
          tlim:
            - 0
            - 20
        error_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: error.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        sliding_surface_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: sliding_mode_s
              label: fl
          tlim:
            - 0
            - 20
      metrics:
        mean_abs_error:
          method: meanabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.steering_angle
            tlim:
              - 0
              - 20
          scale: rad2deg
        final_abs_error:
          method: finalabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.steering_angle
            tlim:
              - 0
              - 20
          scale: rad2deg
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
          scale: 0.001
        mean_torque:
          method: mean
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
          scale: 0.001
  rr_turn:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control report_wheel_controllers_rr.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_wheel_turn.launch.py"
      monitor: TimeLimit20SecMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/rr_turn.db3
        force: true
        rate: 10
      plots:
        reference_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        state_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: state.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        torque_fl:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.steer_torque
              label: fl
              scale: 0.001
          tlim:
            - 0
            - 20
        error_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: error.steering_angle
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        sliding_surface_fl:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: sliding_mode_s
              label: fl
          tlim:
            - 0
            - 20
      metrics:
        mean_abs_error:
          method: meanabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.steering_angle
            tlim:
              - 0
              - 20
          scale: rad2deg
        final_abs_error:
          method: finalabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.steering_angle
            tlim:
              - 0
              - 20
          scale: rad2deg
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
          scale: 0.001
        mean_torque:
          method: mean
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
            tlim:
              - 0
              - 20
          scale: 0.001

  # ---- WHEEL ANGULAR VELOCITY CASE STUDIES ----
  angvel_step:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control report_wheel_controllers.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_wheel_angvel_step.launch.py"
      monitor: TimeLimit20SecMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/angvel_step.db3
        force: true
        rate: 10
      plots:
        reference_fl:
          type: timeseries
          ylabel: "[deg/s]"
          legend: true
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference_optimal.angular_velocity
              label: "$\\omega_r^*$"
              scale: rad2deg
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference.angular_velocity
              label: "$\\omega_r$"
              scale: rad2deg
          tlim:
            - 0
            - 20
        speed:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed
              label: fl
              scale: 3.6
          tlim:
            - 0
            - 20
        state_fl:
          type: timeseries
          ylabel: "[deg/s]"
          legend: true
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: state.angular_velocity
              label: "$\\omega$"
              scale: rad2deg
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference.angular_velocity
              label: "$\\omega^r$"
              scale: rad2deg
          tlim:
            - 0
            - 20
        torque_fl:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.drive_torque
              label: fl
              scale: 0.001
          tlim:
            - 0
            - 20
        error_fl:
          type: timeseries
          ylabel: "[deg/s]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: error.angular_velocity
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
      metrics:
        mean_abs_error:
          method: meanabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.angular_velocity
            tlim:
              - 0
              - 20
          scale: rad2deg
        final_abs_error:
          method: finalabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.angular_velocity
            tlim:
              - 0
              - 20
          scale: rad2deg
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.drive_torque
            tlim:
              - 0
              - 20
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.drive_torque
            tlim:
              - 0
              - 20
          scale: 0.001
        mean_torque:
          method: mean
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.drive_torque
            tlim:
              - 0
              - 20
          scale: 0.001
  angvel_smooth_step:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control report_wheel_controllers.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_wheel_angvel_smooth_step.launch.py"
      monitor: TimeLimit20SecMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/angvel_smooth_step.db3
        force: true
        rate: 10
      plots:
        reference_fl:
          type: timeseries
          ylabel: "[deg/s]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference.angular_velocity
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
        speed:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed
              label: fl
              scale: 3.6
          tlim:
            - 0
            - 20
        state_fl:
          type: timeseries
          ylabel: "[deg/s]"
          legend: true
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: state.angular_velocity
              label: "$\\omega$"
              scale: rad2deg
            - topic: /vehicle/wheel_fl/controller_info
              attribute: reference.angular_velocity
              label: "$\\omega^r$"
              scale: rad2deg
          tlim:
            - 0
            - 20
        torque_fl:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.drive_torque
              label: fl
              scale: 0.001
          tlim:
            - 0
            - 20
        error_fl:
          type: timeseries
          ylabel: "[deg/s]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: error.angular_velocity
              label: fl
              scale: rad2deg
          tlim:
            - 0
            - 20
      metrics:
        mean_abs_error:
          method: meanabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.angular_velocity
            tlim:
              - 0
              - 20
          scale: rad2deg
        final_abs_error:
          method: finalabs
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: error.angular_velocity
            tlim:
              - 0
              - 20
          scale: rad2deg
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.drive_torque
            tlim:
              - 0
              - 20
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.drive_torque
            tlim:
              - 0
              - 20
          scale: 0.001
        mean_torque:
          method: mean
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.drive_torque
            tlim:
              - 0
              - 20
          scale: 0.001

  # ---- GUIDANCE CASE STUDIES ----
  straight_line_convergence:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=true spawn_origin:=false"
        - "ros2 launch control controllers.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_straight.launch.py"
      monitor: TimeLimit60SecMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/straight_line_convergence.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: ""
              scale: abs
        yaw_error:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/controller_info
              attribute: yaw_error
              label: ""
              scale: rad2deg
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: ""
              scale: 3.6
        speed_reference:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_reference
              label: ""
              scale: 3.6

      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error

  straight_line_convergence_spinning:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=true spawn_origin:=false"
        - "ros2 launch control controllers_yawrate.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_straight.launch.py"
        - "ros2 launch operation report_yawrate_step.launch.py"
      monitor: TimeLimit60SecMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/straight_line_convergence.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: ""
              scale: abs
        yaw_error:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/controller_info
              attribute: yaw_error
              label: ""
              scale: rad2deg
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: ""
              scale: 3.6
        speed_reference:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_reference
              label: ""
              scale: 3.6
  simple_lap:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: ""
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: ""
              scale: 3.6
        speed_reference:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_reference
              label: ""
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        path_trajectory:
          type: xy
          legend: false
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
        path_course:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_course
              label: "$\\chi_p$"
        path_curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_curvature
              label: "$\\dot{\\chi}_p$"
        fl_steer_torque:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.steer_torque
              label: ""
              scale: 0.001

      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_abs_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
          scale: abs
        peak_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
        peak_steer_rate:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: state.steering_angle
          scale: rad2deg
  simple_lap_no_reference:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_no_reference.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_no_reference.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: ""
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: ""
              scale: 3.6
        speed_reference:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_reference
              label: ""
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        path_trajectory:
          type: xy
          legend: false
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
        path_course:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_course
              label: "$\\chi_p$"
        path_curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_curvature
              label: "$\\dot{\\chi}_p$"

      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_abs_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
          scale: abs
        peak_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
        peak_steer_rate:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: state.steering_angle
          scale: rad2deg
  simple_lap_better_reference:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_better_reference.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_better_reference.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: ""
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: ""
              scale: 3.6
        speed_reference:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_reference
              label: ""
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        path_trajectory:
          type: xy
          legend: false
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
        path_course:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_course
              label: "$\\chi_p$"
        path_curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_curvature
              label: "$\\dot{\\chi}_p$"

      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_abs_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
          scale: abs
        peak_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
        peak_steer_rate:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: state.steering_angle
          scale: rad2deg

  simple_lap_no_braking:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_no_braking.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_no_braking.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: ""
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: ""
              scale: 3.6
        speed_reference:
          type: timeseries
          ylabel: "[m/s]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_reference
              label: ""
              scale: abs
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/controller_info
              attribute: curvature
              label: "$\\e_c$"
              scale: abs
        path_course:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_course
              label: "$\\chi_p$"
        path_curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_curvature
              label: "$\\dot{\\chi}_p$"
      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
  simple_lap_low_curvature:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_lowcurvature.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_low_curvature.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: "$\\e_c$"
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: "$\\e_c$"
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        path_trajectory:
          type: xy
          legend: false
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
        curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/controller_info
              attribute: curvature
              label: "$\\e_c$"
              scale: abs
      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
  simple_lap_low_speed:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_lowspeed.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_low_speed.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: "$\\e_c$"
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: "$\\e_c$"
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/controller_info
              attribute: curvature
              label: "$\\e_c$"
              scale: abs
      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_abs_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
          scale: abs
        peak_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
        peak_steer_rate:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: state.steering_angle
          scale: rad2deg
  simple_lap_circular:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_circular.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_circular.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: "$\\e_c$"
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: "$\\e_c$"
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/controller_info
              attribute: curvature
              label: "$\\e_c$"
              scale: abs
      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
  simple_lap_low_curvature_high_speed:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_lowcurvature_highspeed.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_low_curvature_high_speed.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: "$\\e_c$"
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: "$\\e_c$"
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/controller_info
              attribute: curvature
              label: "$\\e_c$"
              scale: abs
      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_abs_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
          scale: abs
        peak_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
        peak_steer_rate:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: state.steering_angle
          scale: rad2deg
  simple_lap_low_curvature_high_speed_faster:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_lowcurvature_highspeed_faster.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_low_curvature_high_speed_faster.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: "$\\e_c$"
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: "$\\e_c$"
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/controller_info
              attribute: curvature
              label: "$\\e_c$"
              scale: abs
      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_abs_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
          scale: abs
        peak_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
        peak_steer_rate:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: state.steering_angle
          scale: rad2deg

  simple_lap_curvature_ff:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_curvature_ff.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_curvature_ff.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: ""
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: ""
              scale: 3.6
        speed_reference:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_reference
              label: ""
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        path_trajectory:
          type: xy
          legend: false
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
        path_course:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_course
              label: "$\\chi_p$"
        path_curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_curvature
              label: "$\\dot{\\chi}_p$"
        fl_steer_torque:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.steer_torque
              label: ""
              scale: 0.001

      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_abs_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
          scale: abs
        peak_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
        peak_steer_rate:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: state.steering_angle
          scale: rad2deg
  simple_lap_curvature_ff_slow:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_curvature_ff_slow.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_curvature_ff_slow.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: ""
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: ""
              scale: 3.6
        speed_reference:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_reference
              label: ""
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        path_trajectory:
          type: xy
          legend: false
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
        path_course:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_course
              label: "$\\chi_p$"
        path_curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_curvature
              label: "$\\dot{\\chi}_p$"
        fl_steer_torque:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.steer_torque
              label: ""
              scale: 0.001

      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_abs_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
          scale: abs
        peak_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
        peak_steer_rate:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: state.steering_angle
          scale: rad2deg

  simple_lap_curvature_ff_more:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_curvature_ff_more.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_curvature_ff_more.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: ""
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: ""
              scale: 3.6
        speed_reference:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_reference
              label: ""
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        path_trajectory:
          type: xy
          legend: false
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
        path_course:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_course
              label: "$\\chi_p$"
        path_curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_curvature
              label: "$\\dot{\\chi}_p$"
        fl_steer_torque:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.steer_torque
              label: ""
              scale: 0.001

      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_abs_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
          scale: abs
        peak_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
        peak_steer_rate:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: state.steering_angle
          scale: rad2deg
  simple_lap_curvature_ff_more_high_speed:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_curvature_ff_more_highspeed.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_curvature_ff_more_highspeed.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: ""
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: ""
              scale: 3.6
        speed_reference:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_reference
              label: ""
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        path_trajectory:
          type: xy
          legend: false
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
        path_course:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_course
              label: "$\\chi_p$"
        path_curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: path_curvature
              label: "$\\dot{\\chi}_p$"
        fl_steer_torque:
          type: timeseries
          ylabel: "[kNm]"
          datas:
            - topic: /vehicle/wheel_fl/controller_info
              attribute: cmd.steer_torque
              label: ""
              scale: 0.001

      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_abs_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
          scale: abs
        peak_cross_track_error:
          method: peak
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001
        chatter:
          method: chatter
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
        peak_steer_rate:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: state.steering_angle
          scale: rad2deg

  simple_lap_low_curvature_high_speed_circular:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_lowcurvature_highspeed.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_waypoints_simple_lap.launch.py"
      monitor: SimpleLapMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/simple_lap_low_curvature_high_speed_circular.db3
        force: true
        rate: 10
      plots:
        cross_track_error:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/guidance_info
              attribute: cross_track_error
              label: "$\\e_c$"
              scale: abs
        speed_error:
          type: timeseries
          ylabel: "[km/h]"
          datas:
            - topic: /vehicle/controller_info
              attribute: speed_error
              label: "$\\e_c$"
              scale: 3.6
        trajectory:
          type: xy
          legend: true
          xlabel: "E [m]"
          ylabel: "N [m]"
          datas:
            - topic: /vehicle/guidance_info
              label: path
              xattribute: path_position.x
              yattribute: path_position.y
              alpha: 0.7
            - topic: /vehicle/pose
              label: vehicle
              xattribute: pose.position.x
              yattribute: pose.position.y
        curvature:
          type: timeseries
          ylabel: "[m]"
          datas:
            - topic: /vehicle/controller_info
              attribute: curvature
              label: "$\\e_c$"
              scale: abs
      metrics:
        mean_abs_cross_track_error:
          method: meanabs
          data:
            topic: /vehicle/guidance_info
            attribute: cross_track_error
        peak_torque:
          method: peak
          data:
            topic: /vehicle/wheel_fl/controller_info
            attribute: cmd.steer_torque
          scale: 0.001

  noslip_yawrate:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_yawrate.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_yawrate_step.launch.py"
        # - "ros2 topic pub /vehicle/yaw_reference vehicle_interface/msg/YawReference '{mode: yawrate, yaw: 0.0, yawrate: 0.3}'"
      monitor: TimeLimit20SecMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/noslip_yawrate.db3
        force: true
        rate: 10
      plots:
        yaw:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/controller_info
              attribute: yaw
              label: "$\\psi$"
              scale: rad2deg
        yawrate:
          type: timeseries
          ylabel: "[deg/s]"
          datas:
            - topic: /vehicle/controller_info
              attribute: yawrate
              label: "$\\dot{\\psi}$"
              scale: rad2deg
        yawrate_error:
          type: timeseries
          ylabel: "[deg/s]"
          datas:
            - topic: /vehicle/controller_info
              attribute: yawrate_error
              label: ""
              scale: rad2deg
      # metrics:
  noslip_yaw:
    experimenter: run_commands
    plotter: make_bag_plots
    options:
      commands:
        - "ros2 launch launch/base.launch.py bag:=true rviz:=false"
        - "ros2 launch control controllers_yaw.launch.py"
        - "ros2 launch simulator simulator.launch.py gui:=false"
        - "ros2 launch operation report_yaw_step.launch.py"
      monitor: TimeLimit20SecMonitor
      bagsaver_config: launch/bagsaver.yaml
      bag:
        file: ../bags/noslip_yaw.db3
        force: true
        rate: 10
      plots:
        yaw:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/controller_info
              attribute: yaw
              label: "$\\psi$"
              scale: rad2deg
        yawrate:
          type: timeseries
          ylabel: "[deg/s]"
          datas:
            - topic: /vehicle/controller_info
              attribute: yawrate
              label: "$\\dot{\\psi}$"
              scale: rad2deg
        yaw_error:
          type: timeseries
          ylabel: "[deg]"
          datas:
            - topic: /vehicle/controller_info
              attribute: yaw_error
              label: ""
              scale: rad2deg

  fermat_line:
    #command: python3 launch/make_path_plots.py
    plotter: make_path_plots
    #- ./../build/pathlib_testing
    options:
      num-samples: 100
      waypoints:
        - 1,1
        - 3,4
        - 10,5
        - 18,3
        - 18,10
      smoothing: line
      curvatures:
        - 1.0
  circular_smoothing:
    #command: python3 launch/make_path_plots.py
    plotter: make_path_plots
    #- ./../build/pathlib_testing
    options:
      num-samples: 100
      waypoints:
        - 1,1
        - 3,4
        - 10,5
        - 18,3
        - 18,10
      smoothing: circle
      curvatures:
        - 0.4
  fermat_smoothing_curvature:
    #command: python3 launch/make_path_plots.py
    plotter: make_path_plots
    #- ./../build/pathlib_testing
    options:
      num-samples: 100
      waypoints:
        - 1,1
        - 3,4
        - 10,5
        - 18,3
        - 18,10
      smoothing: fermat
      curvatures:
        - 0.5
  fermat_smoothing_curvatures:
    #command: python3 launch/make_path_plots.py
    plotter: make_path_plots
    #- ./../build/pathlib_testing
    options:
      num-samples: 100
      waypoints:
        - 1,1
        - 3,4
        - 10,5
        - 18,3
        - 18,10
      smoothing: fermat
      curvatures:
        - 0.5
        - 1.0
        - 2.0
      labels:
        - "$\\kappa_{max} = 0.5$"
        - "$\\kappa_{max} = 1.0$"
        - "$\\kappa_{max} = 2.0$"
  fermat_smoothing_invalid:
    plotter: make_path_plots
    options:
      num-samples: 100
      waypoints:
        - 0,0
        - 5,0
        - 5,5
        - 10,5
      smoothing: fermat
      curvatures:
        - 0.4
  fermat_vs_circle:
    plotter: make_path_plots
    options:
      num-samples: 100
      waypoints:
        - 0,0
        - 5,0
        - 4,5
      smoothings:
        - line
        - fermat
        - circle
      curvatures:
        - 0.5
      labels:
        - line
        - circle
        - fermat

  simple_lap_path:
    #command: python3 launch/make_path_plots.py
    plotter: make_path_plots
    #- ./../build/pathlib_testing
    options:
      legend_loc: upper right
      num-samples: 100
      waypoints:
        - 0,0
        - 15,0
        - 30,30
        - 10,30
        - -20,45
        - -10,0
        - 0,0
      smoothing: fermat
      curvatures:
        - 0.5
      # labels:
      #   - "$\\kappa_{max} = 0.5$"
  simple_lap_path_low_curvature:
    #command: python3 launch/make_path_plots.py
    plotter: make_path_plots
    #- ./../build/pathlib_testing
    options:
      legend_loc: upper right
      num-samples: 100
      waypoints:
        - 0,0
        - 15,0
        - 30,30
        - 10,30
        - -20,45
        - -10,0
        - 0,0
      smoothing: fermat
      curvatures:
        - 0.25
      # labels:
      #   - "$\\kappa_{max} = 0.25$"

  chattering_signal:
    plotter: chattering_signal_plotter
    options:
      fig: "../figs/raw/simple_lap/fl_steer_torque.fig"
      tlim:
        - 20
        - 22

  chattering_smc_vs_rr:
    plotter: chattering_comparison
    options:
      figs:
        - "../figs/raw/sliding_mode_results/steering_torque.fig"
        - "../figs/raw/robust_rate_results/steering_torque.fig"
      labels:
        - SMC
        - RR
      tlim:
        - 60
        - 75
      alpha: 0.5
